from pwn import *
from ctypes import CDLL
context.binary = './chal'
libc = CDLL('libc.so.6')
p = process()

#p = remote("34.70.212.151",8006)
libc.srand(libc.time(None))
Fruit = ['Apple','Orange','Mango','Banana','Pineapple',
         'Watermelon','Guava','Kiwi','Strawberry','Peach']
print(p.recv())
#time.sleep(2)
#print(p.recv())
for i in range(0,50):
   payload = Fruit[libc.rand()%10]
   print(payload)
   p.sendlineafter(b'Your guess :',str(payload).encode())
   #time.sleep(1)
   print(p.recv())
#    try:
#       p.recvline()
#       p.recvline()
#       msg = p.recvline()
#       print(msg)
#       if b'No shell for you' in msg: break
#    except Exception:
#       break
   
   

p.interactive()
